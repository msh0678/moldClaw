# moldClaw QA 보고서
> 검증일: 2026-02-25  
> 버전: 0.6.4 (commit: a658119)  
> 검증 방법: 소스 코드 정적 분석

---

## 1. 요약

| 분류 | 개수 |
|------|------|
| 🔴 Critical | 0 |
| 🟠 Major | 2 |
| 🟡 Minor | 4 |
| 🟢 Info | 3 |

---

## 2. 발견된 이슈

### 🟠 Major Issues

#### M1. macOS Node.js 호환성 검사 기준 불일치
**위치**: `src-tauri/src/lib.rs` (라인 1645)

**현상**:
- Windows: `>= 22.12.0 && < 24.0` (정확)
- macOS: `>= 18` (너무 낮음)

**영향**: macOS에서 Node.js 18.x로도 통과되지만, OpenClaw는 `>=22.12.0` 요구

**수정 방안**:
```rust
// 변경 전
.map(|major| major >= 18)

// 변경 후
.map(|major| major >= 22)
```

---

#### M2. node_too_new 경고 미표시
**위치**: `src/components/Loading.tsx`

**현상**:
- `PrerequisiteStatus.node_too_new` 필드 존재
- 실제 UI에서 Node.js 24+ 경고 표시 없음
- 주석에 "Node.js 24+도 일단 설치 시도 (실패 시 에러 분석에서 안내)" 있음

**영향**: Node.js 24+ 설치 시 네이티브 모듈 빌드 실패 가능

**수정 방안**: Loading.tsx에 node_too_new 경고 화면 추가 또는 명시적 안내

---

### 🟡 Minor Issues

#### m1. DisclaimerPage 버전 하드코딩
**위치**: `src/components/pages/DisclaimerPage.tsx` (마지막 줄)

**현상**: `"moldClaw v0.5.3+"` 하드코딩

**영향**: 현재 버전 0.6.4와 불일치

**수정**:
```tsx
// 변경 전
moldClaw v0.5.3+

// 변경 후
moldClaw v{앱버전} 또는 동적 가져오기
```

---

#### m2. macOS Node.js 자동 설치 실패 시 안내 부족
**위치**: `src-tauri/src/lib.rs` (install_nodejs 함수)

**현상**: brew 실패 시 nodejs.org URL만 제공

**개선안**: 
- brew 설치 안내 추가
- nvm/fnm 설치 옵션 제공

---

#### m3. WhatsApp 5분 타임아웃 후 재시도 UX
**위치**: `src/components/onboarding/MessengerConnectStep.tsx`

**현상**: 타임아웃 후 에러 메시지만 표시, 재시도 버튼 없음

**개선안**: "다시 시도" 버튼 추가

---

#### m4. Linux check_prerequisites 더미 구현
**위치**: `src-tauri/src/lib.rs` (라인 1681-1691)

**현상**: 모든 값이 하드코딩 (node_installed: true 등)

**영향**: Linux에서 실제 환경 검사 안 됨

---

### 🟢 Info / 검증 완료

#### i1. DisclaimerPage 동의 로직 ✅
- 3개 체크박스 모두 체크 시에만 버튼 활성화
- localStorage 저장 정상

#### i2. WhatsApp creds.json 폴링 ✅
- 500ms 간격 폴링
- 5분 타임아웃
- 언마운트 시 정리 (clearInterval/clearTimeout)

#### i3. Gateway 상태 관리 ✅
- 5초 간격 상태 체크
- start/stop/restart 함수 존재
- 에러 핸들링 존재

---

## 3. 플랫폼별 검증 결과

### Windows 검증 항목

| # | 항목 | 코드 검증 | 비고 |
|---|------|----------|------|
| W1 | check_prerequisites | ✅ | PrerequisiteStatus 구조체 완전 |
| W2 | antivirus_detected | ✅ | WMI로 SecurityCenter2 조회 |
| W3 | install_nodejs_with_winget | ✅ | winget + 환경변수 새로고침 |
| W4 | vc_redist 설치 | ✅ | PowerShell로 다운로드/설치 |
| W5 | verify_openclaw_status | ✅ | incomplete 감지 포함 |
| W6 | install_openclaw | ✅ | 에러 복구 시스템 포함 |
| W7 | WhatsApp 터미널 | ✅ | CREATE_NEW_CONSOLE 사용 |
| W8 | Gateway 제어 | ✅ | Scheduled Task 방식 |

### macOS 검증 항목

| # | 항목 | 코드 검증 | 비고 |
|---|------|----------|------|
| M1 | PATH 확장 | ✅ | get_macos_path() - login shell 또는 fallback |
| M2 | check_prerequisites | ⚠️ | node_compatible >= 18 (낮음) |
| M3 | install_nodejs | ✅ | brew install node@22 시도 |
| M4 | verify_openclaw_status | ✅ | which + --version |
| M5 | install_openclaw | ✅ | EACCES 권한 문제 처리 |
| M6 | WhatsApp 터미널 | ✅ | AppleScript로 Terminal.app |
| M7 | Gateway 제어 | ✅ | foreground 모드 |

### Linux 검증 항목

| # | 항목 | 코드 검증 | 비고 |
|---|------|----------|------|
| L1 | check_prerequisites | ⚠️ | 더미 구현 (모든 값 true) |
| L2 | WhatsApp 터미널 | ✅ | gnome-terminal/konsole/xfce4/xterm 순차 시도 |
| L3 | Gateway 제어 | ✅ | foreground 모드 |

---

## 4. 설정 패널 검증

### 4.1 AI 모델 (ModelSettings)
- [x] 프로바이더 선택 (3 + 추가)
- [x] 모델 선택
- [x] API 키 입력/마스킹
- [x] 저장 로직

### 4.2 메신저 (MessengerSettings)
- [x] 여러 메신저 동시 연결 지원
- [x] DM 정책 설정 (pairing/allowlist/open)
- [x] Group 정책 설정 (allowlist/open/disabled)
- [x] WhatsApp QR 연결 모달
- [x] 연결 해제 로직 (config + 세션 파일 삭제)

### 4.3 스킬 (SkillsSettings)
- [x] API 연동 탭 (11개)
- [x] CLI 도구 탭 (38개)
- [x] 플랫폼별 필터링
- [x] prerequisite 체크 (go/uv/brew/npm)
- [x] 설치/설정/해제 모달

### 4.4 TTS (TTSSettings)
- [x] 제공자 선택
- [x] 음성 선택

### 4.5 Gmail (GmailSettings)
- [x] OAuth 설정 안내
- [x] Pub/Sub 설정

### 4.6 브라우저 (BrowserSettings)
- [x] Chrome 확장 설치 안내
- [x] 프로필 설정 (chrome/openclaw)
- [x] 활성화/비활성화

---

## 5. 수정 우선순위

1. **M1** - macOS node_compatible 조건 수정 (즉시)
2. **m1** - 버전 하드코딩 수정 (간단)
3. **M2** - node_too_new 경고 추가 (중요)
4. **m4** - Linux check_prerequisites 구현 (향후)

---

## 6. 수정 진행

### 6.1 M1 수정 (macOS node_compatible)

```rust
// lib.rs 라인 1645 근처
// 변경 전: major >= 18
// 변경 후: major >= 22
```

### 6.2 m1 수정 (버전 하드코딩)

```tsx
// DisclaimerPage.tsx 마지막 줄
// 삭제하거나 동적으로 변경
```

---

*QA 보고서 작성 완료*
